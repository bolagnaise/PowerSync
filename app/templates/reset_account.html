{% extends "base.html" %}

{% block content %}
    <h1>Reset Account</h1>

    <article class="alert alert-danger">
        <header><strong>Warning: This action cannot be undone!</strong></header>
        <p>Resetting your account will permanently delete:</p>
        <ul>
            <li>Your login credentials</li>
            <li>All API tokens and settings</li>
            <li>Two-factor authentication</li>
            <li>All saved TOU profiles</li>
            <li>All price and energy history</li>
        </ul>
        <p>After reset, you will need to register a new account and reconfigure all settings.</p>
    </article>

    <article>
        <header><strong>Confirm Account Reset</strong></header>
        <form action="{{ url_for('main.reset_account') }}" method="post">
            {{ form.hidden_tag() }}

            <label for="email">
                Enter your full email address to confirm:
                <small>Registered email: {{ user_email }}</small>
                <input type="email" id="email" name="email" required autocomplete="email" placeholder="your@email.com">
            </label>

            <label for="confirm">
                Type <strong>RESET</strong> to confirm:
                <input type="text" id="confirm" name="confirm" required placeholder="RESET" style="text-transform: uppercase;">
            </label>

            {% if two_factor_enabled %}
            <label for="totp_code">
                Enter your 2FA code:
                <small>Required - 2FA is enabled on this account</small>
                <input type="text" id="totp_code" name="totp_code" required
                       pattern="[0-9]{6}" maxlength="6" inputmode="numeric"
                       placeholder="000000" autocomplete="one-time-code">
            </label>
            {% endif %}

            <div class="button-group">
                <a href="{{ url_for('main.login') }}" role="button" class="outline">Cancel</a>
                <button type="submit" class="danger">Reset Account</button>
            </div>
        </form>
    </article>
{% endblock %}
